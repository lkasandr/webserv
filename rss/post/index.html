<HTML>
	<HEAD>
	   <TITLE> Индивидуальные HTML-поля со списками </TITLE>
	   <STYLE TYPE="text/css">
		  .list {cursor:hand; overflow:auto; height:75pt; width:150pt;
			 border:1pt black solid}
		  .list UL {list-style-type:none; margin-left:2pt;
			 margin-top:0pt; margin-bottom:0pt}
		  .list UL LI {margin-top:0pt; margin-bottom:0pt}
		  .list UL LI.selected {background:navy; color:white}
	   </STYLE>
	   <SCRIPT LANGUAGE="JavaScript">
		  function checkParent(src, tag) {
			 while ("HTML" != src.tagName) {
				if (tag == src.tagName)
				   return src;
				src = src.parentElement;
			 }
			 return null;
		  }
 
		  function selectItem(list) {
			 var el = checkParent(event.srcElement, "LI");
			 if ("LI" == el.tagName) {
				if (null != list.selected)
				   list.selected.className = "";
				if (list.selected != el) {
				   el.className = "selected";
				   list.selected = el;
				}
				else
				   list.selected = null;
			 }
		  }
 
		  function copy(src, dest) {
			 var elSrc = document.all[src];
			 var elDest = document.all[dest];
			 if (elSrc.selected != null) {
				elSrc.selected.className = "";
				elDest.insertAdjacentHTML("beforeEnd",
				   elSrc.selected.outerHTML);
				elSrc.selected.outerHTML = "";
				elSrc.selected = null; // начальная установка выбора
			 }
		  }
	   </SCRIPT>
	</HEAD>
	<BODY>
	   <H1>Custom HTML List Boxes</H1>
	   <P>The bulleted lists simulate rich HTML selection lists.</P>
	   <TABLE>
		  <TR> 
			 <TD>
				<DIV CLASS="list">
				   <UL ID="src" ONCLICK="selectItem(this);"
						 ONDBLCLICK="copy('src', 'dest');">
					  <LI>Scott's <EM>Home</EM> Page</LI>
					  <LI>Parents' Home Page</LI>
					  <LI><IMG SRC="foo.gif"></LI>
					  <LI>Inside Dynamic HTML Home Page</LI>
					  <LI>Microsoft Home Page</LI>
					  <LI>Item 6</LI>
					  <LI>Item 7</LI>
				   </UL>
				</DIV>
			 </TD><TD>
				<P><INPUT TYPE=BUTTON VALUE="—>"
				   ONCLICK="copy('src', 'dest');">
				<P><INPUT TYPE=BUTTON VALUE="<—"
				   ONCLICK="copy('dest', 'src');">
			 </TD><TD>
				<DIV class="list">
				   <UL ID="dest" ONCLICK="selectItem(this);"
					  ONDBLCLICK="copy('dest','src');">
				   </UL>
				</DIV>
			 </TD>
		  </TR>
	   </TABLE>
	</BODY>
 </HTML>